source('~/OneDrive/who/projects/haiti_cholera_2016/rough.R', echo=TRUE)
list_hist_day_post_hurr[1]
list_dat
list_dat_post_hurr <-
map(list_dat, function(data) data %>% filter(year == '2016', epiweek >= 40, date <= today()) %>% mutate(epiweek = factor(epiweek)))
today()
list_dat_post_hurr <-
map(list_dat, function(data) data %>% filter(year == '2016', epiweek >= 40, date <= today()) %>% mutate(epiweek = factor(epiweek)))
list_dat_post_hurr <-
map(list_dat, function(data) data %>% filter(year == '2016', epiweek >= 40) %>% mutate(epiweek = factor(epiweek)))
list_dat_post_hurr
list_dat
list_dat_post_hurr <-
map(list_dat, function(data) data %>% filter(year == '2016', epiweek >= 40) %>% mutate(epiweek = factor(epiweek)))
PlotHistDayPostHurr <- function(data = NULL){
ggplot(data) +
geom_bar(aes(x = date, y = n, fill = commune), stat = 'identity') +
geom_text(
data = data %>% group_by(date) %>% summarise(total = sum(n)),
aes(x = date, y = total + max(total)/50, label = total)
) +
scale_fill_viridis(discrete = TRUE) +
labs(x = 'Date', y = '# cases') +
ggthemes::theme_tufte(base_family = 'GillSans')
}
list_hist_day_post_hurr <- map(list_dat_post_hurr, PlotHistDayPostHurr)
list_hist_day_post_hurr[[1]]
